<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StatisticalMoments · MultipleScattering.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MultipleScattering.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../../base.html">Base</a></li><li><a class="toctext" href="../../acoustics.html">Acoustic</a></li><li><a class="toctext" href="../../random.html">Random</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../box_size/README.html">Box size</a></li><li><a class="toctext" href="../hankel_convergence/README.html">Convergence when increasing the number of Hankel functions</a></li><li><a class="toctext" href="../intro/README.html">Go to introductory example.</a></li><li><a class="toctext" href="../lens/README.html">Lens</a></li><li class="current"><a class="toctext" href="README.html">StatisticalMoments</a><ul class="internal"><li><a class="toctext" href="#Choose-the-type-of-particles-1">Choose the type of particles</a></li><li><a class="toctext" href="#Calculate-the-moments-of-the-scattered-wave-1">Calculate the moments of the scattered wave</a></li><li><a class="toctext" href="#Calculate-the-moments-of-the-scattered-wave-in-time-1">Calculate the moments of the scattered wave in time</a></li><li><a class="toctext" href="#References-1">References</a></li></ul></li><li><a class="toctext" href="../near_surface_backscattering/README.html">Near-surface backscattering</a></li><li><a class="toctext" href="../random_particles/README.html">Simple random particles example</a></li><li><a class="toctext" href="../random_particles_in_circle/README.html">Random particles in a circle</a></li><li><a class="toctext" href="../shapes/README.html">Shapes</a></li><li><a class="toctext" href="../time_response_single_particle/README.html">Time response from single particle</a></li><li><a class="toctext" href="../two_particles/README.html">Two particles</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Examples</li><li><a href="README.html">StatisticalMoments</a></li></ul><a class="edit-page" href="https://github.com/jondea/MultipleScattering.jl/blob/master/docs/src/example/moments/README.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>StatisticalMoments</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="StatisticalMoments-1" href="#StatisticalMoments-1">StatisticalMoments</a></h1><p>Here we are going to simulate the scattered wave for many different configurations of particles. We can then take the average and standard deviation (the moments) of the scattered wave. In statistical mechanics this process is called <a href="https://en.wikipedia.org/wiki/Ensemble_average_(statistical_mechanics)">ensemble average</a>.</p><h2><a class="nav-anchor" id="Choose-the-type-of-particles-1" href="#Choose-the-type-of-particles-1">Choose the type of particles</a></h2><pre><code class="language-julia">using MultipleScattering

volfrac = 0.01
radius = 1.0
num_particles = 10

# region to place the particles
shape = Rectangle(volfrac, radius, num_particles)</code></pre><p>To see the region where the particle will be placed, and the receiver position:</p><pre><code class="language-julia">using Plots
pyplot()
listener = [-10.0, 0.0]
plot(shape);
scatter!([listener[1]],[listener[2]]);
plot_shape = annotate!([(listener_position[1], listener_position[2] -2., &quot;Receiver&quot;)])</code></pre><p><img src="shape_receiver.png" alt="Plot of shape and receiver"/></p><h2><a class="nav-anchor" id="Calculate-the-moments-of-the-scattered-wave-1" href="#Calculate-the-moments-of-the-scattered-wave-1">Calculate the moments of the scattered wave</a></h2><p>The code below chooses a random (uniform distribution) configuration of particles inside <code>shape</code> and calculates the received signal at <code>listener</code> for wavenumbers <code>k_arr</code>,</p><pre><code class="language-julia">k_arr = collect(linspace(0.01,1.0,100))
simulation = FrequencySimulation(volfrac,radius,k_arr; shape=shape, listener_positions = listener, seed = 1)
plot(simulation)</code></pre><p><img src="plot_simulation.png" alt="Plot of response against wavenumber"/></p><p>To see the position of the chosen particles:</p><pre><code class="language-julia">plot(plot_shape)
plot!.(simulation.particles);
plot!()</code></pre><p><img src="plot_particles.png" alt="Plot of the position of the particles"/></p><p>Now we will do simulations for particles placed in many different configurations and take the moments:</p><pre><code class="language-julia">simulations = [
    FrequencySimulation(volfrac,radius,k_arr; shape=shape, listener_positions = listener, seed = i)
for i = 1:20]
real_moments = StatisticalMoments(simulations; response_apply=real) # moments of the real part
plot(real_moments);
plot!(xlabel=&quot;wavenumbers&quot;, title=&quot;Moments of the real part&quot;)</code></pre><p><img src="plot_moments.png" alt="Moments of the real part the scattered waves"/></p><h2><a class="nav-anchor" id="Calculate-the-moments-of-the-scattered-wave-in-time-1" href="#Calculate-the-moments-of-the-scattered-wave-in-time-1">Calculate the moments of the scattered wave in time</a></h2><pre><code class="language-julia">time_simulations = TimeSimulation.(simulations)
time_simulations[1].time_arr # the time_arr chosen will be based on the discrete Fourier transform of simulations[1].k_arr
real_time_moments = StatisticalMoments(time_simulations; response_apply=real) # moments of the real part
plot(real_time_moments,xlims=(0,300));
plot!(xlabel=&quot;time&quot;, title=&quot;Moments of the real part of the time wave&quot;)</code></pre><p><img src="plot_time_moments.png" alt="Moments of the real part the scattered waves in time"/></p><h2><a class="nav-anchor" id="References-1" href="#References-1">References</a></h2><p>A. L. Gower, R. M. Gower, J. Deakin, W. J. Parnell, I. D. Abrahams, Learning about random media from near-surface backscattering: using machine learning to measure particle size and concentration, arXiv preprint, (2018)1801.05490</p><footer><hr/><a class="previous" href="../lens/README.html"><span class="direction">Previous</span><span class="title">Lens</span></a><a class="next" href="../near_surface_backscattering/README.html"><span class="direction">Next</span><span class="title">Near-surface backscattering</span></a></footer></article></body></html>

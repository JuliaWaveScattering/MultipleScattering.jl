<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StatisticalMoments · MultipleScattering.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../../"><img class="logo" src="../../../assets/logo.png" alt="MultipleScattering.jl logo"/></a><h1>MultipleScattering.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../../../manual/intro/">Introduction</a></li><li><a class="toctext" href="../../../manual/source/">Sources</a></li><li><a class="toctext" href="../../../manual/shapes/">Shapes</a></li><li><a class="toctext" href="../../../manual/particles/">Particles</a></li><li><a class="toctext" href="../../../manual/time_response/">Time response</a></li><li><a class="toctext" href="../../../manual/plot/">Plotting</a></li><li><a class="toctext" href="../../../manual/new_types/">New particles</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../../../library/base/">Base</a></li><li><a class="toctext" href="../../../library/acoustics/">Acoustic</a></li><li><a class="toctext" href="../../../library/random/">Random</a></li></ul></li><li><a class="toctext" href="../../../maths/README/">Theory</a></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../README/">Overview</a></li><li><a class="toctext" href="../../box_size/README/">Box size</a></li><li><a class="toctext" href="../../hankel_convergence/README/">Convergence when increasing the number of Hankel functions</a></li><li class="current"><a class="toctext" href>StatisticalMoments</a><ul class="internal"><li><a class="toctext" href="#Region-and-particles-properties-1">Region and particles properties</a></li><li><a class="toctext" href="#The-moments-of-the-scattered-wave-1">The moments of the scattered wave</a></li><li><a class="toctext" href="#Calculate-the-moments-of-the-scattered-wave-in-time-1">Calculate the moments of the scattered wave in time</a></li><li><a class="toctext" href="#References-1">References</a></li></ul></li><li><a class="toctext" href="../../near_surface_backscattering/README/">Near-surface backscattering</a></li><li><a class="toctext" href="../../random_particles/README/">Simple random particles example</a></li><li><a class="toctext" href="../../time_response_single_particle/README/">Time response from single particle</a></li><li><a class="toctext" href="../../two_particles/README/">OUT-DATED needs to be updated</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Examples</li><li><a href>StatisticalMoments</a></li></ul><a class="edit-page" href="https://github.com/jondea/MultipleScattering.jl/blob/master/docs/src/example/moments/README.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>StatisticalMoments</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="StatisticalMoments-1" href="#StatisticalMoments-1">StatisticalMoments</a></h1><p>Here we are going to simulate the scattered wave for many different configurations of particles. We can then take the average and standard deviation (the moments) of the scattered wave. In statistical mechanics this process is called <a href="https://en.wikipedia.org/wiki/Ensemble_average_(statistical_mechanics)">ensemble average</a>.</p><h2><a class="nav-anchor" id="Region-and-particles-properties-1" href="#Region-and-particles-properties-1">Region and particles properties</a></h2><p>First we choose the region to place particles and the receiver position:</p><pre><code class="language-julia">bottomleft = [0.0;-25.0]
topright = [50.0;25.0]
shape = Rectangle(bottomleft, topright)
x = [-10.0,0.0]</code></pre><pre><code class="language-julia">using Plots
plot(shape);
scatter!([x[1]],[x[2]], label=&quot;&quot;);
plot_shape = annotate!([(x[1], x[2] -2., &quot;Receiver&quot;)])</code></pre><p><img src="../shape_receiver.png" alt="Plot of shape and receiver"/></p><p>Next we fill this <code>shape</code> with a random (uniform distribution) configuration of particles:</p><pre><code class="language-julia">volfrac = 0.05
radius = 1.0

particles = random_particles(Acoustic(2; ρ=0.0, c=0.0), Circle(radius);
        region_shape = shape,
        volume_fraction = volfrac,
        seed=2
);

typeof(particles)

# output
Array{AbstractParticle{Float64,2},1}</code></pre><p>To see the position of the chosen particles:</p><pre><code class="language-julia">plot(plot_shape)
plot!(particles);
plot!()</code></pre><p><img src="../plot_particles.png" alt="Plot particles"/></p><p>Scattering a plane-wave from these particles  </p><pre><code class="language-julia">ωs = LinRange(0.01,1.0,100)
plane_wave = plane_source(Acoustic(1.0, 1.0, 2);
    direction = [1.0,0.0], position = x);
sim = FrequencySimulation(particles, plane_wave);</code></pre><pre><code class="language-julia">plot(run(sim,x,ωs))</code></pre><p><img src="../plot_result.png" alt/></p><h2><a class="nav-anchor" id="The-moments-of-the-scattered-wave-1" href="#The-moments-of-the-scattered-wave-1">The moments of the scattered wave</a></h2><p>Now we will do simulations for particles placed in many different configurations and take the moments:</p><pre><code class="language-julia">results = map(1:20) do i
    particles = random_particles(Acoustic(2; ρ=0.0, c=0.0), Circle(radius);
            region_shape = shape,
            volume_fraction = volfrac,
            seed=i
    )
    run(FrequencySimulation(particles, plane_wave), x, ωs)
end

# package Plots changed it&#39;s argument, the below no longer works..
# num_moments = 3
# plot(results; field_apply = real, num_moments = num_moments)
# plot!(xlabel=&quot;wavenumbers&quot;, title=&quot;Moments of the real part&quot;)</code></pre><p><img src="../plot_moments.png" alt="Moments of the real part the scattered waves"/></p><h2><a class="nav-anchor" id="Calculate-the-moments-of-the-scattered-wave-in-time-1" href="#Calculate-the-moments-of-the-scattered-wave-in-time-1">Calculate the moments of the scattered wave in time</a></h2><pre><code class="language-julia">time_simulations = frequency_to_time.(results)
time_simulations[1].t # the time_arr chosen will be based on the discrete Fourier transform of simulations[1].k_arr
# real_time_moments = StatisticalMoments(time_simulations; response_apply=real) # moments of the real part
# plot(real_time_moments,xlims=(0,300));
# plot!(xlabel=&quot;time&quot;, title=&quot;Moments of the real part of the time wave&quot;)</code></pre><p><img src="../plot_time_moments.png" alt="Moments of the real part the scattered waves in time"/></p><h2><a class="nav-anchor" id="References-1" href="#References-1">References</a></h2><p>A. L. Gower, R. M. Gower, J. Deakin, W. J. Parnell, I. D. Abrahams, Learning about random media from near-surface backscattering: using machine learning to measure particle size and concentration, arXiv preprint, (2018)1801.05490</p><footer><hr/><a class="previous" href="../../hankel_convergence/README/"><span class="direction">Previous</span><span class="title">Convergence when increasing the number of Hankel functions</span></a><a class="next" href="../../near_surface_backscattering/README/"><span class="direction">Next</span><span class="title">Near-surface backscattering</span></a></footer></article></body></html>
